(function(n){"use strict";var t=function(t){this.options=n.extend({},n.i18n.parser.defaults,t);this.language=n.i18n.languages[String.locale]||n.i18n.languages["default"];this.emitter=n.i18n.parser.emitter};t.prototype={constructor:t,simpleParse:function(n,t){return n.replace(/\$(\d+)/g,function(n,i){var r=parseInt(i,10)-1;return t[r]!==undefined?t[r]:"$"+i})},parse:function(t,i){return t.indexOf("{{")<0?this.simpleParse(t,i):(this.emitter.language=n.i18n.languages[n.i18n().locale]||n.i18n.languages["default"],this.emitter.emit(this.ast(t),i))},ast:function(n){function r(n){return function(){for(var i,t=0;t<n.length;t++)if(i=n[t](),i!==null)return i;return null}}function i(n){for(var r,f=t,u=[],i=0;i<n.length;i++){if(r=n[i](),r===null)return t=f,null;u.push(r)}return u}function u(n,i){return function(){for(var f=t,r=[],u=i();u!==null;)r.push(u),u=i();return r.length<n?(t=f,null):r}}function f(i){var r=i.length;return function(){var u=null;return n.substr(t,r)===i&&(u=i,t+=r),u}}function e(i){return function(){var r=n.substr(t).match(i);return r===null?null:(t+=r[0].length,r[0])}}function st(n,t){return function(){var i=n();return i===null?null:t(i)}}function ht(){var n=u(1,nt)();return n===null?null:n.join("")}function ct(){var n=u(1,tt)();return n===null?null:n.join("")}function l(){var n=i([y,p]);return n===null?null:n[1]}function a(){var n=i([w,b]);return n===null?null:["REPLACE",parseInt(n[1],10)-1]}function et(){var n,t=i([v,u(0,h)]);return t===null?null:(n=t[1],n.length>1?["CONCAT"].concat(n):n[0])}function lt(){var n=i([o,s,a]);return n===null?null:[n[0],n[2]]}function at(){var n=i([o,s,h]);return n===null?null:[n[0],n[2]]}function ot(){var n=i([rt,it,ut]);return n===null?null:n[1]}function vt(){var n=u(0,ft)();return n===null?null:["CONCAT"].concat(n)}var v,s,y,p,w,b,k,d,g,nt,tt,it,o,rt,ut,ft,h,c,t=0;if(v=f("|"),s=f(":"),y=f("\\"),p=e(/^./),w=f("$"),b=e(/^\d+/),k=e(/^[^{}\[\]$\\]/),d=e(/^[^{}\[\]$\\|]/),g=e(/^[^{}\[\]$\s]/),r([l,g]),nt=r([l,d]),tt=r([l,k]),o=st(e(/^[ !"$&'()*,.\/0-9;=?@A-Z\^_`a-z~\x80-\xFF+\-]+/),function(n){return n.toString()}),it=r([function(){var n=i([r([lt,at]),u(0,et)]);return n===null?null:n[0].concat(n[1])},function(){var n=i([o,u(0,et)]);return n===null?null:[n[0]].concat(n[1])}]),rt=f("{{"),ut=f("}}"),ft=r([ot,a,ct]),h=r([ot,a,ht]),c=vt(),c===null||t!==n.length)throw new Error("Parse error at position "+t.toString()+" in input: "+n);return c}};n.extend(n.i18n.parser,new t)})(jQuery);